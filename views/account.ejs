<!DOCTYPE html>
<html lang="en">

<head>
    <% include partials/header %>
        <!-- For Modal CSS -->
        <link href="./css/bootstrap.min.css" rel="stylesheet" />
        <!-- Required by bootstrap js -->
        <script src="./js/jquery-2.1.3.min.js"></script>
        <!-- For Modal boxes -->
        <script src="./js/bootstrap-3.3.5.min.js"></script>
        <!--For Copy to Clipboard button -->
        <script src="./js/clipboard-1.7.1.min.js"></script>
        <link rel="stylesheet" type="text/css" href="./css/swagger-ui.css">
</head>

<body>
    <% include partials/topbar %>
        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position:absolute;width:0;height:0">
            <defs>
                <symbol viewBox="0 0 20 20" id="close">
                    <path d="M14.348 14.849c-.469.469-1.229.469-1.697 0L10 11.819l-2.651 3.029c-.469.469-1.229.469-1.697 0-.469-.469-.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-.469-.469-.469-1.228 0-1.697.469-.469 1.228-.469 1.697 0L10 8.183l2.651-3.031c.469-.469 1.228-.469 1.697 0 .469.469.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c.469.469.469 1.229 0 1.698z"
                    />
                </symbol>
                <symbol viewBox="0 0 20 20" id="large-arrow">
                    <path d="M13.25 10L6.109 2.58c-.268-.27-.268-.707 0-.979.268-.27.701-.27.969 0l7.83 7.908c.268.271.268.709 0 .979l-7.83 7.908c-.268.271-.701.27-.969 0-.268-.269-.268-.707 0-.979L13.25 10z"
                    />
                </symbol>
                <symbol viewBox="0 0 20 20" id="large-arrow-down">
                    <path d="M17.418 6.109c.272-.268.709-.268.979 0s.271.701 0 .969l-7.908 7.83c-.27.268-.707.268-.979 0l-7.908-7.83c-.27-.268-.27-.701 0-.969.271-.268.709-.268.979 0L10 13.25l7.418-7.141z"
                    />
                </symbol>
            </defs>
        </svg>
        <div class="wrapper">
            <div class="info">
                <hgroup class="main">
                    <h2 class="title">
                        WinMan REST API<small><pre class="version"> <%= version %> </pre></small> - <%= title %>
                    </h2>
                    <pre class="base-url">[ Base URL: <%= baseUrl %>/<%= system %> ]</pre>
                    <a target="_blank" href="//<%= baseUrl %>/swagger/schema/<%= sessionId %>.json">
                            <span class="url">View the schema</span>
                        </a>
                </hgroup>
                <div class="system-notice">
                    You are currently using the <strong><%= system %></strong> system. To switch, you will need to log out
                    and log back in again.
                </div>
                <div id="account" class="section">
                    <span>Welcome,
                        <%= user.name %>!</span>
                    <button class="btn btn-success" id="changePasswordButton">Change Password</button>
                </div>
            </div>
            <% if (typeof message !== 'undefined') { %>
                <%= message %>
                    <% } %>
                        <div id="clients" class="section">
                            <span>Clients</span>
                            <!-- <button class="expand-operation" title="Expand operation"><svg class="arrow" width="20" height="20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#large-arrow"></use></svg></button> -->
                            <button class="btn btn-success" id="newClientButton">Create new client</button>
                            <table id="userClients" class="table table-striped">
                            </table>
                        </div>
                        <div id="tokens" class="section">
                            <span>Access Tokens</span>
                            <!-- <button class="btn btn-danger" id="revokeButton">Revoke All</button> -->
                            <table id="accessTokens" class="table table-striped">
                            </table>
                        </div>
                        <!-- Create Client Modal -->
                        <div class="modal" id="createModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close close-modal" data-dismiss="modal" aria-hidden="true"><svg width="20" height="20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg></button>
                                        <h3 class="modal-title">Client Permissions</h3>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            Which scopes would you like to grant your new client access to?
                                        </p>
                                        <p class="error">
                                            Please select at least one scope.
                                        </p>
                                        <form role="form" name="createClient" id="createClient">
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                                        <button type="button" class="btn btn-success" onclick="$('#createClient').submit()">Create Client</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Delete Client Modal -->
                        <div class="modal" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close close-modal" data-dismiss="modal" aria-hidden="true"><svg width="20" height="20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg></button>
                                        <h3 class="modal-title">Delete Client</h3>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            <strong>Are you sure you want to delete this client?</strong>
                                        </p>
                                        <p>
                                            The client and all associated authorisation codes and access tokens will be deleted immediately if you proceed.
                                        </p>
                                        <p>
                                            This action <strong class="danger">cannot be undone</strong>.
                                        </p>
                                        <p>
                                            If you are sure you wish to proceed, please check this box to confirm you understand the above message:
                                            <input type="checkbox" class="continue" data-for="deleteClient" />
                                        </p>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">No, cancel.</button>
                                            <button type="button" class="btn btn-danger" id="deleteClient" disabled="disabled">Yes, I'm sure!</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Revoke Token Modal -->
                        <div class="modal" id="revokeModal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close close-modal" data-dismiss="modal" aria-hidden="true"><svg width="20" height="20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg></button>
                                        <h3 class="modal-title">Revoke Access Token</h3>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            <strong>Are you sure you want to revoke this access token?</strong>
                                        </p>
                                        <p>
                                            Any applications using this access token will immediately lose access to the API if you proceed.
                                        </p>
                                        <p>
                                            This action <strong class="danger">cannot be undone</strong>.
                                        </p>
                                        <p>
                                            If you are sure you wish to proceed, please check this box to confirm you understand the above message:
                                            <input type="checkbox" class="continue" data-for="revokeToken" />
                                        </p>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">No, cancel.</button>
                                            <button type="button" class="btn btn-danger" id="revokeToken" disabled="disabled">Yes, I'm sure!</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Token Modal -->
                        <div class="modal" id="tokenModal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close close-modal" data-dismiss="modal" aria-hidden="true"><svg width="20" height="20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg></button>
                                        <h3 class="modal-title">Access Token</h3>
                                    </div>
                                    <div class="modal-body">
                                        <p>
                                            Here is your access token. For security reasons, this is not stored anywhere in your account, so please make a note of it
                                            and keep it in a safe place. If you ever lose this token, you will need to request
                                            a new one.
                                        </p>
                                        <p>
                                            <strong>Access Token:</strong>
                                        </p>
                                        <p id="token" style="word-wrap: break-word"></p>
                                        <p class="button-wrapper">
                                            <button type="button" class="btn btn-default" id="copy-button" data-clipboard-target="#token" data-toggle="tooltip" title="Copy to Clipboard">Copy</button>
                                        </p>
                                        <p>
                                            <strong>Expires:</strong>
                                        </p>
                                        <p id="expires" style="word-wrap: break-word"></p>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Change Passsword Modal -->
                        <div class="modal" id="changePasswordModal" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close close-modal" data-dismiss="modal" aria-hidden="true"><svg width="20" height="20"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#close"></use></svg></button>
                                        <h3 class="modal-title">Change Password</h3>
                                    </div>
                                    <div class="modal-body">
                                        <form role="form" name="changePassword" id="changePassword">
                                            <p>
                                                Please enter your <strong>new</strong> password in both boxes below:
                                            </p>
                                            <p>
                                                <input type="password" placeholder="New password" name="newPassword" id="newPassword" style="color: #000" />
                                                <span class="missing error">
                                                    New password is required.
                                                </span>
                                                <span class="mismatch error">
                                                    Passwords do not match.
                                                </span>
                                                <span class="validation"></span>
                                            </p>
                                            <p>
                                                <input type="password" placeholder="Confirm password" name="confirmPassword" id="confirmPassword" style="color: #000" />
                                                <span class="missing error">
                                                    Password confirmation is required.
                                                </span>
                                            </p>
                                            <p>
                                                For security, please enter your <strong>current</strong> password:
                                            </p>
                                            <p>
                                                <input type="password" placeholder="Current password" name="currentPassword" id="currentPassword" style="color: #000" />
                                                <span class="missing error">
                                                    Current password is required.
                                                </span>
                                                <span class="mismatch error">
                                                    Password incorrect.
                                                </span>
                                            </p>
                                        </form>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                                            <button type="button" class="btn btn-success" onclick="$('#changePassword').submit()">Change Password</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
        </div>
        <script src="./js/account.js"></script>
</body>

</html>